<!DOCTYPE html>
<html class="writer-html5" lang="fr" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>8. Hockey Application Version 3 - Android Programming</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../style.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "8. Hockey Application Version 3";
        var mkdocs_page_input_path = "2. Android/08-hockey-v3.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> Android Programming
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Android Programming</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">1. Kotlin</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../1.%20Kotlin/01-kotlin/">The Kotlin Programming Language</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../1.%20Kotlin/02-kotlin-android/">Kotlin for Android</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">2. Android</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../01-intro/">1. Introduction to Mobile and Android Programming</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../02-intro-compose/">2. Introduction to Jetpack Compose</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../03-premi%C3%A8re-app/">3. First Application with Jetpack Compose</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../04-hockey-v1/">4. Hockey Application Version 1</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../05-etats-evenements/">5. State and Event Management</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../06-hockey-v2/">6. Hockey Application Version 2</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../07-orientation/">7. Screen Orientation</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">8. Hockey Application Version 3</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#different-versions-of-playerlistwithsearch">Different Versions of PlayerListWithSearch</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#previous-version">Previous Version</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#general-description">General Description</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#detailed-description">Detailed Description</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#new-version">New Version</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../09-etats-evenements-v2/">9. State and Event Management</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../10-localisation/">10. Localization</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../11-json/">11. Reading and Writing JSON Files</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../12-cycle-de-vie/">12. Lifecycle and Architecture</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../13-architecture/">13. Architecture</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../14-navigation/">14. Navigation in Jetpack Compose</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../15-intentions/">15. Intents</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../16-intentions-vs-navigation/">16. Intents vs. Navigation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../17-images-distantes/">17. Displaying Remote Images and Videos</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">Android Programming</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">2. Android</li>
      <li class="breadcrumb-item active">8. Hockey Application Version 3</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="8-hockey-application-version-3">8. Hockey Application Version 3</h1>
<h2 id="different-versions-of-playerlistwithsearch">Different Versions of <code>PlayerListWithSearch</code></h2>
<h3 id="previous-version">Previous Version</h3>
<pre><code class="language-kotlin">@Composable
fun PlayerListWithSearch(modifier: Modifier = Modifier) {
    var nameSearch by rememberSaveable { mutableStateOf(&quot;&quot;) }
    var numberSearch: Int? by rememberSaveable { mutableStateOf(null) }
    Column(modifier = modifier) {
        Column(modifier = Modifier.padding(top = 20.dp, bottom = 20.dp)) {
            TextField(
                value = nameSearch,
                label = { Text(text = &quot;Name&quot;) },
                onValueChange = { nameSearch = it },
                modifier = Modifier
                    .fillMaxWidth()
                    .padding(start = 20.dp, end = 20.dp)
            )
            TextField(
                value = (numberSearch ?: &quot;&quot;).toString(),
                label = { Text(text = &quot;Number&quot;) },
                onValueChange = {
                    numberSearch = if (it.isEmpty()) null else it.toIntOrNull() ?: numberSearch
                },
                modifier = Modifier
                    .fillMaxWidth()
                    .padding(start = 20.dp, end = 20.dp)
            )
        }

        LazyColumn(modifier = Modifier.fillMaxSize()) {
            items(getPlayers(nameSearch, numberSearch)) {
                HockeyPlayerCard(player = it)
            }
        }
    }
}
</code></pre>
<h4 id="general-description">General Description</h4>
<p>This code defines a composable function named <code>PlayerListWithSearch</code> that creates a user interface to display a list of
hockey players with search functionality. The interface includes two text fields for searching (one for name and one for
number) and a scrollable list of players matching the search criteria.</p>
<h4 id="detailed-description">Detailed Description</h4>
<p>1- Function Declaration:</p>
<pre><code class="language-kotlin">@Composable
fun PlayerListWithSearch(modifier: Modifier = Modifier)
</code></pre>
<ul>
<li>It's a composable function that accepts an optional <code>modifier</code> as a parameter.</li>
</ul>
<p>2- State Variables:</p>
<pre><code class="language-kotlin">var nameSearch by rememberSaveable { mutableStateOf(&quot;&quot;) }
var numberSearch: Int? by rememberSaveable { mutableStateOf(null) }
</code></pre>
<ul>
<li><code>nameSearch</code>: A string to store the name search.</li>
<li><code>numberSearch</code>: A nullable integer to store the number search.</li>
<li>These variables use <code>rememberSaveable</code> to preserve their state even after reconfiguration.</li>
</ul>
<p>3- Main Structure:</p>
<pre><code class="language-kotlin">Column(modifier = modifier) {
    // Content
}
</code></pre>
<ul>
<li>Uses a <code>Column</code> as the main container with the modifier passed as parameter.</li>
</ul>
<p>4- Search Fields:</p>
<pre><code class="language-kotlin">Column(modifier = Modifier.padding(top = 20.dp, bottom = 20.dp)) {
    // Text fields
}
</code></pre>
<ul>
<li>An inner <code>Column</code> with padding to contain the search fields.</li>
</ul>
<p>5- Name Search Field:</p>
<pre><code class="language-kotlin">TextField(
    value = nameSearch,
    label = { Text(text = &quot;Name&quot;) },
    onValueChange = { nameSearch = it },
    modifier = Modifier
        .fillMaxWidth()
        .padding(start = 20.dp, end = 20.dp)
)
</code></pre>
<ul>
<li>A <code>TextField</code> for name search.</li>
<li>The value is bound to <code>nameSearch</code>.</li>
<li>The label displays "Name".</li>
<li><code>onValueChange</code> updates <code>nameSearch</code> with the new value.</li>
</ul>
<p>6- Number Search Field:</p>
<pre><code class="language-kotlin">TextField(
    value = (numberSearch ?: &quot;&quot;).toString(),
    label = { Text(text = &quot;Number&quot;) },
    onValueChange = {
        numberSearch = if (it.isEmpty()) null else it.toIntOrNull() ?: numberSearch
    },
    modifier = Modifier
        .fillMaxWidth()
        .padding(start = 20.dp, end = 20.dp)
)
</code></pre>
<ul>
<li>A <code>TextField</code> for number search.</li>
<li>The displayed value is the string conversion of <code>numberSearch</code> (or empty string if null).</li>
<li>The label displays "Number".</li>
<li><code>onValueChange</code> attempts to convert the input to an integer, keeping the previous value if conversion fails.</li>
</ul>
<p>7- Player List:</p>
<pre><code class="language-kotlin">LazyColumn(modifier = Modifier.fillMaxSize()) {
    items(getPlayers(nameSearch, numberSearch)) {
        HockeyPlayerCard(player = it)
    }
}
</code></pre>
<ul>
<li>Uses a <code>LazyColumn</code> to efficiently display a potentially long list of players.</li>
<li><code>getPlayers(nameSearch, numberSearch)</code> is called to get the filtered list of players.</li>
<li>Each player is displayed using a <code>HockeyPlayerCard</code> component.</li>
</ul>
<p>This code creates an interactive user interface allowing users to search for hockey players by name and number, with
dynamic updating of the displayed list based on search criteria.</p>
<h3 id="new-version">New Version</h3>
<pre><code class="language-kotlin">@Composable
fun PlayerListWithSearch(modifier: Modifier = Modifier) {
    var nameSearch by rememberSaveable { mutableStateOf(&quot;&quot;) }
    var numberSearch: Int? by rememberSaveable { mutableStateOf(null) }
    Column(modifier = modifier) {
        SearchTextFields(
            nameSearch = nameSearch,
            onNameChange = { nameSearch = it },
            numberSearch = numberSearch,
            onNumberChange =
                { numberSearch = if (it.isEmpty()) null else it.toIntOrNull() ?: numberSearch })

        LazyColumn(modifier = Modifier.fillMaxSize()) {
            items(getPlayers(nameSearch, numberSearch)) {
                HockeyPlayerCard(player = it)
            }
        }
    }
}

@Composable
private fun SearchTextFields(
    nameSearch: String,
    onNameChange: (String) -&gt; Unit,
    numberSearch: Int?,
    onNumberChange: (String) -&gt; Unit,
) {
    Column(modifier = Modifier.padding(top = 20.dp, bottom = 20.dp)) {
        TextField(
            value = nameSearch,
            label = { Text(text = &quot;Name&quot;) },
            onValueChange = onNameChange,
            modifier = Modifier
                .fillMaxWidth()
                .padding(start = 20.dp, end = 20.dp)
        )
        TextField(
            value = (numberSearch ?: &quot;&quot;).toString(),
            label = { Text(text = &quot;Number&quot;) },
            onValueChange = onNumberChange,
            modifier = Modifier
                .fillMaxWidth()
                .padding(start = 20.dp, end = 20.dp)
        )
    }
}
</code></pre>
<p>This refactoring illustrates how to improve code structure and reusability in Jetpack Compose. Here's a detailed
explanation of the transition between the two versions, focusing on state management and lambda functions:</p>
<ol>
<li>
<p>Creation of the new <code>SearchTextFields</code> composable:</p>
<ul>
<li>A new private composable was created to encapsulate the search fields logic.</li>
<li>This improves code readability and reusability.</li>
</ul>
</li>
<li>
<p>Parameters of the new composable:</p>
<ul>
<li><code>nameSearch: String</code>: The current value of the name search.</li>
<li><code>onNameChange: (String) -&gt; Unit</code>: A lambda function to handle name changes.</li>
<li><code>numberSearch: Int?</code>: The current value of the number search.</li>
<li><code>onNumberChange: (String) -&gt; Unit</code>: A lambda function to handle number changes.</li>
</ul>
</li>
<li>
<p>Passing state variables:</p>
<ul>
<li>In <code>PlayerListWithSearch</code>, state variables <code>nameSearch</code> and <code>numberSearch</code> are passed directly to
  <code>SearchTextFields</code>.</li>
<li>This allows <code>SearchTextFields</code> to use these values without owning or modifying them directly.</li>
</ul>
</li>
<li>
<p>Passing lambda functions:</p>
<ul>
<li>For <code>onNameChange</code>, a simple lambda is passed: <code>{ nameSearch = it }</code>.
  This lambda directly updates the <code>nameSearch</code> state variable.</li>
<li>For <code>onNumberChange</code>, the conversion logic is passed as a lambda:
  <code>kotlin
  { numberSearch = if (it.isEmpty()) null else it.toIntOrNull() ?: numberSearch }</code>
  This lambda handles the string to integer conversion and updating <code>numberSearch</code>.</li>
</ul>
</li>
<li>
<p>Usage in <code>SearchTextFields</code>:</p>
<ul>
<li>The <code>TextField</code>s now use the passed parameters instead of directly accessing state variables.</li>
<li><code>value = nameSearch</code> and <code>value = (numberSearch ?: "").toString()</code> use the passed values.</li>
<li><code>onValueChange = onNameChange</code> and <code>onValueChange = onNumberChange</code> use the passed lambdas.</li>
</ul>
</li>
<li>
<p>Advantages of this approach:</p>
<ul>
<li>Separation of concerns: <code>SearchTextFields</code> only handles display and input collection.</li>
<li>State hoisting: State remains in the parent component, making <code>SearchTextFields</code> more flexible and reusable.</li>
<li>Improved testability: It's easier to test <code>SearchTextFields</code> independently.</li>
</ul>
</li>
<li>
<p>Implications for state management:</p>
<ul>
<li>State (<code>nameSearch</code> and <code>numberSearch</code>) is still managed in <code>PlayerListWithSearch</code>.</li>
<li><code>SearchTextFields</code> becomes a stateless component, only reflecting the state passed to it.</li>
</ul>
</li>
</ol>
<p>This refactoring is an excellent example of how to apply the "state hoisting" principle in Jetpack Compose, by elevating
state and state modification functions to the parent component. This makes the code more modular, easier to maintain and
test, while maintaining a clear separation of responsibilities between components.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../07-orientation/" class="btn btn-neutral float-left" title="7. Screen Orientation"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../09-etats-evenements-v2/" class="btn btn-neutral float-right" title="9. State and Event Management">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../07-orientation/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../09-etats-evenements-v2/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
